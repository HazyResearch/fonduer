sudo: false
dist: trusty

language:
  - python
  - java

python:
  - "2.7"
  - "3.5"
  - "3.6"

jdk:
  - oraclejdk8

# Avoid repeatedly downloading these
cache:
  directories:
    - parser
    - phantomjs
    - poppler

services:
  - postgresql

addons:
  apt:
    packages:
      - oracle-java8-installer  # for CoreNLP
  postgresql: "9.6"

notifications:
  email: false

install:
  - sudo apt-get -qq update
  - pip install -r python-package-requirement.txt
  - ./install-parser.sh
  - ./install-poppler.sh
  - ./install-phantomjs.sh

before_script:
  - psql -c 'create database parser_test;' -U postgres
  - source ./set_env.sh

script:
  - travis_wait pytest tests -rs

after_script:
  - killall java
